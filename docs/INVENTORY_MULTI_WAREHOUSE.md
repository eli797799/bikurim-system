# ניהול מלאי רב־מחסני (חלק 7)

## סקירה

המערכת מנהלת מלאי ב־3 מחסנים נפרדים (או יותר):

- **מבנה מחסן:** שם, קוד מחסן, מיקום, מחסנאי אחראי, סטטוס (פעיל/לא פעיל).
- **מלאי לפי מחסן:** מוצר, כמות נוכחית, יחידה, כמות מינימום (התראה), תאריך עדכון אחרון.
- **כניסה (קבלת משלוח):** מוצר, כמות, תאריך, מקור (ספק/העברה פנימית/אחר), הערה.
- **יציאה (הוצאת סחורה):** מוצר, כמות, יעד, תאריך, הערה. אם הכמות המבוקשת גדולה מהמלאי – מוצגת אזהרה.
- **יומן תנועות:** תאריך, סוג (כניסה/יציאה), מוצר, כמות, משתמש, הערה. לא ניתן למחוק תנועות.
- **התראות:** חוסר מלאי (כמות ≤ כמות מינימום); דף התראות לקניין.

## הרצת מיגרציות

להפעלת ניהול המלאי הרב־מחסני יש להריץ (לאחר הסכמה והמיגרציה של מחסנים):

```bash
psql "$DATABASE_URL" -f docs/database/migration_inventory_multiple_warehouses.sql
```

המיגרציה מוסיפה/מרחיבה:

- **warehouses:** `code`, `location`, `responsible_user_id`
- **users:** `warehouse_id`, תפקיד `warehouse_worker`
- **warehouse_inventory:** מלאי לפי מחסן ומוצר
- **inventory_movements:** יומן תנועות (כניסה/יציאה)

## תצוגת מחסנאי

- **קניין/מנהל:** גישה דרך "מחסנים" → "מלאי" למחסן, יומן תנועות, התראות חוסר מלאי.
- **מחסנאי:** קישור ישיר למחסן אחד: `/warehouse/:id` (ללא 's'). מסך פשוט: רשימת מלאי, כפתורים "קיבלתי משלוח" ו"הוצאתי סחורה", יומן תנועות. מותאם לנייד.

## הרשאות (עתידי)

- מחסנאי: רואה רק את המחסן שלו ואת התנועות שלו (כשיהיה login).
- קניין: רואה את כל המחסנים ויכול להפיק דוחות.
